# ==============================================================================
# Owl Browser License Server - Environment Configuration
# ==============================================================================
# Copy this file to .env and modify as needed.
# For local development, defaults point to localhost.
# For production, update URLs and use strong passwords.
# ==============================================================================

# ==============================================================================
# Database Configuration
# ==============================================================================
# SQLite (simple, no setup required):
# OLIB_DB_TYPE=sqlite

# PostgreSQL (recommended for Docker):
OLIB_DB_TYPE=postgresql
OLIB_DB_HOST=localhost
OLIB_DB_PORT=5432
OLIB_DB_NAME=olib_licenses
OLIB_DB_USER=olib
OLIB_DB_PASSWORD=olib_dev_2024

# ==============================================================================
# Admin Server Configuration
# ==============================================================================
OLIB_ADMIN_PORT=3035
OLIB_ADMIN_HOST=0.0.0.0
OLIB_ADMIN_USERNAME=admin

# Password hash - generate with:
# python -c "from werkzeug.security import generate_password_hash; print(generate_password_hash('your_password'))"
# NOTE: Put password hash in secrets.env to avoid $ interpolation issues
OLIB_ADMIN_PASSWORD_HASH=

# Flask secret key for session management
# Generate with: python -c "import secrets; print(secrets.token_hex(32))"
OLIB_ADMIN_SECRET_KEY=change-this-to-a-random-string-in-production

# ==============================================================================
# License API Server Configuration
# ==============================================================================
# License server URL (localhost for dev, your domain for production)
# Local dev:  http://localhost:3034
# Production: https://license.yourdomain.com
OLIB_LICENSE_SERVER_URL=http://localhost:3034
OLIB_LICENSE_SERVER_HOST=0.0.0.0
OLIB_LICENSE_SERVER_PORT=3034

# HMAC secret for nonce authentication (MUST match browser build!)
# Generate with: python -c "import secrets; print(secrets.token_hex(32))"
OWL_NONCE_HMAC_SECRET=change-this-to-match-browser-secret

# ==============================================================================
# Session Configuration
# ==============================================================================
SESSION_LIFETIME_HOURS=168
NONCE_TIMESTAMP_TOLERANCE=300

# ==============================================================================
# Key Management
# ==============================================================================
# Auto-generate RSA keys on first start
# WARNING: New keys will invalidate ALL existing licenses!
# For production: mount existing keys to /app/keys/ and set to false
GENERATE_KEYS=true

# ==============================================================================
# Development Mode (local testing only)
# ==============================================================================
# Enable dev mode to bypass strict license validation
DEV_LICENSE_MODE=true

# Allow any hardware fingerprint (don't enforce hardware binding)
ALLOW_ANY_FINGERPRINT=true

# Skip signature verification for dev licenses
DEV_SKIP_SIGNATURE_CHECK=true

# ==============================================================================
# Production Recommendations
# ==============================================================================
# 1. Set DEV_LICENSE_MODE=false
# 2. Set ALLOW_ANY_FINGERPRINT=false
# 3. Set DEV_SKIP_SIGNATURE_CHECK=false
# 4. Use strong, unique passwords
# 5. Generate random secret keys
# 6. Mount existing RSA keys rather than generating new ones
# 7. Enable HTTPS via reverse proxy (nginx, traefik, etc.)
# 8. Set up regular backups for /app/data and /app/keys
# ==============================================================================
